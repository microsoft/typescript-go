SourceFile
  FunctionDeclaration
    Identifier: ' f1'
    Block
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' b'
            TrueKeyword
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' obj'
            ObjectLiteralExpression
              ShorthandPropertyAssignment
                Identifier: ' b'
      ExpressionStatement
        BinaryExpression
          PropertyAccessExpression
            Identifier: '
    // Desired: OK
    // 3.0: OK
    // 3.1 as-is: OK
    // 3.1 minus widening propagation: error
    obj'
            Identifier: 'b'
          EqualsToken
          FalseKeyword
  FunctionDeclaration
    Identifier: ' f2'
    Block
      TypeAliasDeclaration
        Identifier: ' Element'
        ParenthesizedType
          UnionType
            StringKeyword
            LiteralType
              FalseKeyword
      TypeAliasDeclaration
        Identifier: ' ElementOrArray'
        UnionType
          TypeReference
            Identifier: ' Element'
          ArrayType
            TypeReference
              Identifier: ' Element'
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' el'
            TypeReference
              Identifier: ' Element'
            AsExpression
              NullKeyword
              AnyKeyword
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' arr'
            ArrayType
              TypeReference
                Identifier: ' Element'
            AsExpression
              NullKeyword
              AnyKeyword
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' elOrA'
            TypeReference
              Identifier: ' ElementOrArray'
            AsExpression
              NullKeyword
              AnyKeyword
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' a1'
            TypeReference
              Identifier: ' ElementOrArray'
            Identifier: ' el'
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' a2'
            TypeReference
              Identifier: ' ElementOrArray'
            Identifier: ' arr'
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' a3'
            TypeReference
              Identifier: ' ElementOrArray'
            ArrayLiteralExpression
              Identifier: 'el'
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' a4'
            TypeReference
              Identifier: ' ElementOrArray'
            ConditionalExpression
              CallExpression
                PropertyAccessExpression
                  Identifier: ' Array'
                  Identifier: 'isArray'
                Identifier: 'elOrA'
              QuestionToken
              Identifier: ' elOrA'
              ColonToken
              ArrayLiteralExpression
                Identifier: 'elOrA'
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' a5'
            TypeReference
              Identifier: ' ElementOrArray'
            ArrayLiteralExpression
              SpreadElement
                ConditionalExpression
                  CallExpression
                    PropertyAccessExpression
                      Identifier: 'Array'
                      Identifier: 'isArray'
                    Identifier: 'elOrA'
                  QuestionToken
                  Identifier: ' elOrA'
                  ColonToken
                  ArrayLiteralExpression
                    Identifier: 'elOrA'
  FunctionDeclaration
    Identifier: ' f3'
    Block
      TypeAliasDeclaration
        Identifier: ' XY'
        UnionType
          LiteralType
            StringLiteral
          LiteralType
            StringLiteral
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' x'
            TypeReference
              Identifier: ' XY'
            StringLiteral
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' x2'
            Identifier: ' x'
      ExpressionStatement
        BinaryExpression
          Identifier: '
    // Desired: OK (up for debate?)
    // 3.0: Error
    // 3.1 as-is: OK
    x2'
          EqualsToken
          StringLiteral
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' x3'
            TypeReference
              Identifier: ' XY'
            Identifier: ' x'
      ExpressionStatement
        BinaryExpression
          Identifier: '
    x3'
          EqualsToken
          StringLiteral
  FunctionDeclaration
    Identifier: ' f4'
    Block
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' x'
            BooleanKeyword
            TrueKeyword
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' x1'
            Identifier: ' x'
      ExpressionStatement
        BinaryExpression
          Identifier: '
    // Desired: OK
    // 3.0: OK
    // 3.1: OK
    // 3.1 minus widening propagation: error
    x1'
          EqualsToken
          FalseKeyword
  FunctionDeclaration
    Identifier: ' f5'
    Block
      TypeAliasDeclaration
        Identifier: ' XY'
        UnionType
          LiteralType
            StringLiteral
          LiteralType
            StringLiteral
      VariableStatement
        VariableDeclarationList
          VariableDeclaration
            Identifier: ' arr'
            ArrayType
              TypeReference
                Identifier: ' XY'
            ArrayLiteralExpression
              StringLiteral
      ExpressionStatement
        BinaryExpression
          Identifier: '
    arr'
          EqualsToken
          ArrayLiteralExpression
            StringLiteral
      ExpressionStatement
        BinaryExpression
          Identifier: '
    // Desired: OK
    // Error in all extant branches
    arr'
          EqualsToken
          ArrayLiteralExpression
            SpreadElement
              ArrayLiteralExpression
                StringLiteral
