SourceFile
  ModuleDeclaration
    DeclareKeyword
    Identifier: ' Windows'
    ModuleDeclaration
      Identifier: 'Foundation'
      ModuleBlock
        InterfaceDeclaration
          ExportKeyword
          Identifier: ' IPromise'
          TypeParameter
            Identifier: 'T'
          MethodSignature
            Identifier: '
        then'
            TypeParameter
              Identifier: 'U'
            Parameter
              Identifier: 'success'
              QuestionToken
              FunctionType
                Parameter
                  Identifier: 'value'
                  TypeReference
                    Identifier: ' T'
                TypeReference
                  Identifier: ' IPromise'
                  TypeReference
                    Identifier: 'U'
            Parameter
              Identifier: ' error'
              QuestionToken
              FunctionType
                Parameter
                  Identifier: 'error'
                  AnyKeyword
                TypeReference
                  Identifier: ' IPromise'
                  TypeReference
                    Identifier: 'U'
            Parameter
              Identifier: ' progress'
              QuestionToken
              FunctionType
                Parameter
                  Identifier: 'progress'
                  AnyKeyword
                VoidKeyword
            TypeReference
              QualifiedName
                QualifiedName
                  Identifier: ' Windows'
                  Identifier: 'Foundation'
                Identifier: 'IPromise'
              TypeReference
                Identifier: 'U'
          MethodSignature
            Identifier: '
        then'
            TypeParameter
              Identifier: 'U'
            Parameter
              Identifier: 'success'
              QuestionToken
              FunctionType
                Parameter
                  Identifier: 'value'
                  TypeReference
                    Identifier: ' T'
                TypeReference
                  Identifier: ' IPromise'
                  TypeReference
                    Identifier: 'U'
            Parameter
              Identifier: ' error'
              QuestionToken
              FunctionType
                Parameter
                  Identifier: 'error'
                  AnyKeyword
                TypeReference
                  Identifier: ' U'
            Parameter
              Identifier: ' progress'
              QuestionToken
              FunctionType
                Parameter
                  Identifier: 'progress'
                  AnyKeyword
                VoidKeyword
            TypeReference
              QualifiedName
                QualifiedName
                  Identifier: ' Windows'
                  Identifier: 'Foundation'
                Identifier: 'IPromise'
              TypeReference
                Identifier: 'U'
          MethodSignature
            Identifier: '
        then'
            TypeParameter
              Identifier: 'U'
            Parameter
              Identifier: 'success'
              QuestionToken
              FunctionType
                Parameter
                  Identifier: 'value'
                  TypeReference
                    Identifier: ' T'
                TypeReference
                  Identifier: ' U'
            Parameter
              Identifier: ' error'
              QuestionToken
              FunctionType
                Parameter
                  Identifier: 'error'
                  AnyKeyword
                TypeReference
                  Identifier: ' IPromise'
                  TypeReference
                    Identifier: 'U'
            Parameter
              Identifier: ' progress'
              QuestionToken
              FunctionType
                Parameter
                  Identifier: 'progress'
                  AnyKeyword
                VoidKeyword
            TypeReference
              QualifiedName
                QualifiedName
                  Identifier: ' Windows'
                  Identifier: 'Foundation'
                Identifier: 'IPromise'
              TypeReference
                Identifier: 'U'
          MethodSignature
            Identifier: '
        then'
            TypeParameter
              Identifier: 'U'
            Parameter
              Identifier: 'success'
              QuestionToken
              FunctionType
                Parameter
                  Identifier: 'value'
                  TypeReference
                    Identifier: ' T'
                TypeReference
                  Identifier: ' U'
            Parameter
              Identifier: ' error'
              QuestionToken
              FunctionType
                Parameter
                  Identifier: 'error'
                  AnyKeyword
                TypeReference
                  Identifier: ' U'
            Parameter
              Identifier: ' progress'
              QuestionToken
              FunctionType
                Parameter
                  Identifier: 'progress'
                  AnyKeyword
                VoidKeyword
            TypeReference
              QualifiedName
                QualifiedName
                  Identifier: ' Windows'
                  Identifier: 'Foundation'
                Identifier: 'IPromise'
              TypeReference
                Identifier: 'U'
          MethodSignature
            Identifier: '
        done'
            QuestionToken
            TypeParameter
              Identifier: 'U'
            Parameter
              Identifier: 'success'
              QuestionToken
              FunctionType
                Parameter
                  Identifier: 'value'
                  TypeReference
                    Identifier: ' T'
                AnyKeyword
            Parameter
              Identifier: ' error'
              QuestionToken
              FunctionType
                Parameter
                  Identifier: 'error'
                  AnyKeyword
                AnyKeyword
            Parameter
              Identifier: ' progress'
              QuestionToken
              FunctionType
                Parameter
                  Identifier: 'progress'
                  AnyKeyword
                VoidKeyword
            VoidKeyword
  VariableStatement
    VariableDeclarationList
      VariableDeclaration
        Identifier: ' p'
        TypeReference
          QualifiedName
            QualifiedName
              Identifier: ' Windows'
              Identifier: 'Foundation'
            Identifier: 'IPromise'
          NumberKeyword
        NullKeyword
  ExpressionStatement
    CallExpression
      PropertyAccessExpression
        Identifier: '
 
p'
        Identifier: 'then'
      FunctionExpression
        Parameter
          Identifier: 'x'
        Block
  ExpressionStatement
    CallExpression
      PropertyAccessExpression
        CallExpression
          PropertyAccessExpression
            Identifier: ' // should not error
p'
            Identifier: 'then'
          FunctionExpression
            Parameter
              Identifier: 'x'
            Block
              ReturnStatement
                StringLiteral
        Identifier: 'then'
      FunctionExpression
        Parameter
          Identifier: 'x'
        Block
          ReturnStatement
            Identifier: ' x'
