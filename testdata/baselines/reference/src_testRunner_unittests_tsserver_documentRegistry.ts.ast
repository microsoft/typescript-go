SourceFile
  ImportDeclaration
    ImportClause
      NamedImports
        ImportSpecifier
          Identifier: ' reportDocumentRegistryStats'
    StringLiteral
  ImportDeclaration
    ImportClause
      NamespaceImport
        Identifier: ' ts'
    StringLiteral
  ImportDeclaration
    ImportClause
      NamedImports
        ImportSpecifier
          Identifier: ' jsonToReadableText'
    StringLiteral
  ImportDeclaration
    ImportClause
      NamedImports
        ImportSpecifier
          Identifier: '
    baselineTsserverLogs'
        ImportSpecifier
          Identifier: '
    closeFilesForSession'
        ImportSpecifier
          Identifier: '
    openFilesForSession'
        ImportSpecifier
          Identifier: '
    TestSession'
    StringLiteral
  ImportDeclaration
    ImportClause
      NamedImports
        ImportSpecifier
          Identifier: '
    File'
        ImportSpecifier
          Identifier: '
    TestServerHost'
    StringLiteral
  ExpressionStatement
    CallExpression
      Identifier: '

describe'
      StringLiteral
      ArrowFunction
        EqualsGreaterThanToken
        Block
          VariableStatement
            VariableDeclarationList
              VariableDeclaration
                Identifier: ' importModuleContent'
                NoSubstitutionTemplateLiteral
          VariableStatement
            VariableDeclarationList
              VariableDeclaration
                Identifier: ' file'
                TypeReference
                  Identifier: ' File'
                ObjectLiteralExpression
                  PropertyAssignment
                    Identifier: '
        path'
                    NoSubstitutionTemplateLiteral
                  PropertyAssignment
                    Identifier: '
        content'
                    Identifier: ' importModuleContent'
          VariableStatement
            VariableDeclarationList
              VariableDeclaration
                Identifier: ' moduleFile'
                TypeReference
                  Identifier: ' File'
                ObjectLiteralExpression
                  PropertyAssignment
                    Identifier: '
        path'
                    NoSubstitutionTemplateLiteral
                  PropertyAssignment
                    Identifier: '
        content'
                    StringLiteral
          VariableStatement
            VariableDeclarationList
              VariableDeclaration
                Identifier: ' configFile'
                TypeReference
                  Identifier: ' File'
                ObjectLiteralExpression
                  PropertyAssignment
                    Identifier: '
        path'
                    NoSubstitutionTemplateLiteral
                  PropertyAssignment
                    Identifier: '
        content'
                    CallExpression
                      Identifier: ' jsonToReadableText'
                      ObjectLiteralExpression
                        PropertyAssignment
                          Identifier: ' files'
                          ArrayLiteralExpression
                            StringLiteral
          FunctionDeclaration
            Identifier: ' getProject'
            Parameter
              Identifier: 'session'
              TypeReference
                Identifier: ' TestSession'
            Block
              ReturnStatement
                NonNullExpression
                  CallExpression
                    PropertyAccessExpression
                      PropertyAccessExpression
                        CallExpression
                          PropertyAccessExpression
                            Identifier: ' session'
                            Identifier: 'getProjectService'
                        Identifier: 'configuredProjects'
                      Identifier: 'get'
                    PropertyAccessExpression
                      Identifier: 'configFile'
                      Identifier: 'path'
          FunctionDeclaration
            Identifier: ' checkProject'
            Parameter
              Identifier: 'session'
              TypeReference
                Identifier: ' TestSession'
            Parameter
              Identifier: ' moduleIsOrphan'
              BooleanKeyword
            Block
              VariableStatement
                VariableDeclarationList
                  VariableDeclaration
                    Identifier: ' project'
                    CallExpression
                      Identifier: ' getProject'
                      Identifier: 'session'
              ExpressionStatement
                CallExpression
                  PropertyAccessExpression
                    Identifier: '
        project'
                    Identifier: 'getLanguageService'
              VariableStatement
                VariableDeclarationList
                  VariableDeclaration
                    Identifier: ' moduleInfo'
                    NonNullExpression
                      CallExpression
                        PropertyAccessExpression
                          CallExpression
                            PropertyAccessExpression
                              Identifier: ' session'
                              Identifier: 'getProjectService'
                          Identifier: 'getScriptInfo'
                        PropertyAccessExpression
                          Identifier: 'moduleFile'
                          Identifier: 'path'
              ExpressionStatement
                CallExpression
                  PropertyAccessExpression
                    Identifier: '
        assert'
                    Identifier: 'isDefined'
                  Identifier: 'moduleInfo'
              ExpressionStatement
                CallExpression
                  PropertyAccessExpression
                    Identifier: '
        assert'
                    Identifier: 'equal'
                  CallExpression
                    PropertyAccessExpression
                      Identifier: 'moduleInfo'
                      Identifier: 'isOrphan'
                  Identifier: ' moduleIsOrphan'
              ExpressionStatement
                CallExpression
                  PropertyAccessExpression
                    PropertyAccessExpression
                      Identifier: '
        session'
                      Identifier: 'logger'
                    Identifier: 'log'
                  StringLiteral
              ExpressionStatement
                CallExpression
                  PropertyAccessExpression
                    PropertyAccessExpression
                      Identifier: '
        session'
                      Identifier: 'logger'
                    Identifier: 'log'
                  CallExpression
                    PropertyAccessExpression
                      CallExpression
                        Identifier: 'reportDocumentRegistryStats'
                        PropertyAccessExpression
                          CallExpression
                            PropertyAccessExpression
                              Identifier: 'session'
                              Identifier: 'getProjectService'
                          Identifier: 'documentRegistry'
                      Identifier: 'join'
                    StringLiteral
          FunctionDeclaration
            Identifier: ' createSessionAndHost'
            Block
              VariableStatement
                VariableDeclarationList
                  VariableDeclaration
                    Identifier: ' host'
                    CallExpression
                      PropertyAccessExpression
                        Identifier: ' TestServerHost'
                        Identifier: 'createServerHost'
                      ArrayLiteralExpression
                        Identifier: 'file'
                        Identifier: ' moduleFile'
                        Identifier: ' configFile'
              VariableStatement
                VariableDeclarationList
                  VariableDeclaration
                    Identifier: ' session'
                    NewExpression
                      Identifier: ' TestSession'
                      Identifier: 'host'
              ExpressionStatement
                CallExpression
                  Identifier: '
        openFilesForSession'
                  ArrayLiteralExpression
                    Identifier: 'file'
                  Identifier: ' session'
              ExpressionStatement
                CallExpression
                  Identifier: '
        checkProject'
                  Identifier: 'session'
                  FalseKeyword
              ReturnStatement
                ObjectLiteralExpression
                  ShorthandPropertyAssignment
                    Identifier: ' host'
                  ShorthandPropertyAssignment
                    Identifier: ' session'
          FunctionDeclaration
            Identifier: ' changeFileToNotImportModule'
            Parameter
              Identifier: 'session'
              TypeReference
                Identifier: ' TestSession'
            Block
              ExpressionStatement
                CallExpression
                  PropertyAccessExpression
                    Identifier: '
        session'
                    Identifier: 'executeCommandSeq'
                  TypeReference
                    QualifiedName
                      QualifiedName
                        QualifiedName
                          Identifier: 'ts'
                          Identifier: 'server'
                        Identifier: 'protocol'
                      Identifier: 'ChangeRequest'
                  ObjectLiteralExpression
                    PropertyAssignment
                      Identifier: '
            command'
                      PropertyAccessExpression
                        PropertyAccessExpression
                          PropertyAccessExpression
                            PropertyAccessExpression
                              Identifier: ' ts'
                              Identifier: 'server'
                            Identifier: 'protocol'
                          Identifier: 'CommandTypes'
                        Identifier: 'Change'
                    PropertyAssignment
                      Identifier: '
            arguments'
                      ObjectLiteralExpression
                        PropertyAssignment
                          Identifier: '
                file'
                          PropertyAccessExpression
                            Identifier: ' file'
                            Identifier: 'path'
                        PropertyAssignment
                          Identifier: '
                line'
                          NumericLiteral
                        PropertyAssignment
                          Identifier: '
                offset'
                          NumericLiteral
                        PropertyAssignment
                          Identifier: '
                endLine'
                          NumericLiteral
                        PropertyAssignment
                          Identifier: '
                endOffset'
                          BinaryExpression
                            PropertyAccessExpression
                              Identifier: ' importModuleContent'
                              Identifier: 'length'
                            PlusToken
                            NumericLiteral
                        PropertyAssignment
                          Identifier: '
                insertString'
                          StringLiteral
              ExpressionStatement
                CallExpression
                  Identifier: '
        checkProject'
                  Identifier: 'session'
                  TrueKeyword
          FunctionDeclaration
            Identifier: ' changeFileToImportModule'
            Parameter
              Identifier: 'session'
              TypeReference
                Identifier: ' TestSession'
            Block
              ExpressionStatement
                CallExpression
                  PropertyAccessExpression
                    Identifier: '
        session'
                    Identifier: 'executeCommandSeq'
                  TypeReference
                    QualifiedName
                      QualifiedName
                        QualifiedName
                          Identifier: 'ts'
                          Identifier: 'server'
                        Identifier: 'protocol'
                      Identifier: 'ChangeRequest'
                  ObjectLiteralExpression
                    PropertyAssignment
                      Identifier: '
            command'
                      PropertyAccessExpression
                        PropertyAccessExpression
                          PropertyAccessExpression
                            PropertyAccessExpression
                              Identifier: ' ts'
                              Identifier: 'server'
                            Identifier: 'protocol'
                          Identifier: 'CommandTypes'
                        Identifier: 'Change'
                    PropertyAssignment
                      Identifier: '
            arguments'
                      ObjectLiteralExpression
                        PropertyAssignment
                          Identifier: '
                file'
                          PropertyAccessExpression
                            Identifier: ' file'
                            Identifier: 'path'
                        PropertyAssignment
                          Identifier: '
                line'
                          NumericLiteral
                        PropertyAssignment
                          Identifier: '
                offset'
                          NumericLiteral
                        PropertyAssignment
                          Identifier: '
                endLine'
                          NumericLiteral
                        PropertyAssignment
                          Identifier: '
                endOffset'
                          NumericLiteral
                        PropertyAssignment
                          Identifier: '
                insertString'
                          Identifier: ' importModuleContent'
              ExpressionStatement
                CallExpression
                  Identifier: '
        checkProject'
                  Identifier: 'session'
                  FalseKeyword
          ExpressionStatement
            CallExpression
              Identifier: '

    it'
              StringLiteral
              ArrowFunction
                EqualsGreaterThanToken
                Block
                  VariableStatement
                    VariableDeclarationList
                      VariableDeclaration
                        ObjectBindingPattern
                          BindingElement
                            Identifier: ' session'
                        CallExpression
                          Identifier: ' createSessionAndHost'
                  VariableStatement
                    VariableDeclarationList
                      VariableDeclaration
                        Identifier: ' project'
                        CallExpression
                          Identifier: ' getProject'
                          Identifier: 'session'
                  VariableStatement
                    VariableDeclarationList
                      VariableDeclaration
                        Identifier: ' moduleInfo'
                        NonNullExpression
                          CallExpression
                            PropertyAccessExpression
                              CallExpression
                                PropertyAccessExpression
                                  Identifier: ' session'
                                  Identifier: 'getProjectService'
                              Identifier: 'getScriptInfo'
                            PropertyAccessExpression
                              Identifier: 'moduleFile'
                              Identifier: 'path'
                  VariableStatement
                    VariableDeclarationList
                      VariableDeclaration
                        Identifier: ' sourceFile'
                        PropertyAccessExpression
                          NonNullExpression
                            PropertyAccessExpression
                              Identifier: ' moduleInfo'
                              Identifier: 'cacheSourceFile'
                          Identifier: 'sourceFile'
                  ExpressionStatement
                    CallExpression
                      PropertyAccessExpression
                        Identifier: '
        assert'
                        Identifier: 'equal'
                      CallExpression
                        PropertyAccessExpression
                          Identifier: 'project'
                          Identifier: 'getSourceFile'
                        PropertyAccessExpression
                          Identifier: 'moduleInfo'
                          Identifier: 'path'
                      Identifier: ' sourceFile'
                  ExpressionStatement
                    CallExpression
                      Identifier: '

        // edit file
        changeFileToNotImportModule'
                      Identifier: 'session'
                  ExpressionStatement
                    CallExpression
                      PropertyAccessExpression
                        Identifier: '
        assert'
                        Identifier: 'equal'
                      PropertyAccessExpression
                        NonNullExpression
                          PropertyAccessExpression
                            Identifier: 'moduleInfo'
                            Identifier: 'cacheSourceFile'
                        Identifier: 'sourceFile'
                      Identifier: ' sourceFile'
                  ExpressionStatement
                    CallExpression
                      Identifier: '

        // write content back
        changeFileToImportModule'
                      Identifier: 'session'
                  ExpressionStatement
                    CallExpression
                      PropertyAccessExpression
                        Identifier: '
        assert'
                        Identifier: 'equal'
                      PropertyAccessExpression
                        NonNullExpression
                          PropertyAccessExpression
                            Identifier: 'moduleInfo'
                            Identifier: 'cacheSourceFile'
                        Identifier: 'sourceFile'
                      Identifier: ' sourceFile'
                  ExpressionStatement
                    CallExpression
                      PropertyAccessExpression
                        Identifier: '
        assert'
                        Identifier: 'equal'
                      CallExpression
                        PropertyAccessExpression
                          Identifier: 'project'
                          Identifier: 'getSourceFile'
                        PropertyAccessExpression
                          Identifier: 'moduleInfo'
                          Identifier: 'path'
                      Identifier: ' sourceFile'
                  ExpressionStatement
                    CallExpression
                      Identifier: '
        baselineTsserverLogs'
                      StringLiteral
                      StringLiteral
                      Identifier: ' session'
          ExpressionStatement
            CallExpression
              Identifier: '

    it'
              StringLiteral
              ArrowFunction
                EqualsGreaterThanToken
                Block
                  VariableStatement
                    VariableDeclarationList
                      VariableDeclaration
                        ObjectBindingPattern
                          BindingElement
                            Identifier: ' host'
                          BindingElement
                            Identifier: ' session'
                        CallExpression
                          Identifier: ' createSessionAndHost'
                  VariableStatement
                    VariableDeclarationList
                      VariableDeclaration
                        Identifier: ' project'
                        CallExpression
                          Identifier: ' getProject'
                          Identifier: 'session'
                  VariableStatement
                    VariableDeclarationList
                      VariableDeclaration
                        Identifier: ' moduleInfo'
                        NonNullExpression
                          CallExpression
                            PropertyAccessExpression
                              CallExpression
                                PropertyAccessExpression
                                  Identifier: ' session'
                                  Identifier: 'getProjectService'
                              Identifier: 'getScriptInfo'
                            PropertyAccessExpression
                              Identifier: 'moduleFile'
                              Identifier: 'path'
                  VariableStatement
                    VariableDeclarationList
                      VariableDeclaration
                        Identifier: ' sourceFile'
                        PropertyAccessExpression
                          NonNullExpression
                            PropertyAccessExpression
                              Identifier: ' moduleInfo'
                              Identifier: 'cacheSourceFile'
                          Identifier: 'sourceFile'
                  ExpressionStatement
                    CallExpression
                      PropertyAccessExpression
                        Identifier: '
        assert'
                        Identifier: 'equal'
                      CallExpression
                        PropertyAccessExpression
                          Identifier: 'project'
                          Identifier: 'getSourceFile'
                        PropertyAccessExpression
                          Identifier: 'moduleInfo'
                          Identifier: 'path'
                      Identifier: ' sourceFile'
                  ExpressionStatement
                    CallExpression
                      Identifier: '

        // edit file
        changeFileToNotImportModule'
                      Identifier: 'session'
                  ExpressionStatement
                    CallExpression
                      PropertyAccessExpression
                        Identifier: '
        assert'
                        Identifier: 'equal'
                      PropertyAccessExpression
                        NonNullExpression
                          PropertyAccessExpression
                            Identifier: 'moduleInfo'
                            Identifier: 'cacheSourceFile'
                        Identifier: 'sourceFile'
                      Identifier: ' sourceFile'
                  VariableStatement
                    VariableDeclarationList
                      VariableDeclaration
                        Identifier: ' updatedModuleContent'
                        BinaryExpression
                          PropertyAccessExpression
                            Identifier: ' moduleFile'
                            Identifier: 'content'
                          PlusToken
                          StringLiteral
                  ExpressionStatement
                    CallExpression
                      PropertyAccessExpression
                        Identifier: '
        host'
                        Identifier: 'writeFile'
                      PropertyAccessExpression
                        Identifier: 'moduleFile'
                        Identifier: 'path'
                      Identifier: ' updatedModuleContent'
                  ExpressionStatement
                    CallExpression
                      Identifier: '

        // write content back
        changeFileToImportModule'
                      Identifier: 'session'
                  ExpressionStatement
                    CallExpression
                      PropertyAccessExpression
                        Identifier: '
        assert'
                        Identifier: 'notEqual'
                      PropertyAccessExpression
                        NonNullExpression
                          PropertyAccessExpression
                            Identifier: 'moduleInfo'
                            Identifier: 'cacheSourceFile'
                        Identifier: 'sourceFile'
                      Identifier: ' sourceFile'
                  ExpressionStatement
                    CallExpression
                      PropertyAccessExpression
                        Identifier: '
        assert'
                        Identifier: 'equal'
                      CallExpression
                        PropertyAccessExpression
                          Identifier: 'project'
                          Identifier: 'getSourceFile'
                        PropertyAccessExpression
                          Identifier: 'moduleInfo'
                          Identifier: 'path'
                      PropertyAccessExpression
                        NonNullExpression
                          PropertyAccessExpression
                            Identifier: ' moduleInfo'
                            Identifier: 'cacheSourceFile'
                        Identifier: 'sourceFile'
                  ExpressionStatement
                    CallExpression
                      PropertyAccessExpression
                        Identifier: '
        assert'
                        Identifier: 'equal'
                      PropertyAccessExpression
                        PropertyAccessExpression
                          NonNullExpression
                            PropertyAccessExpression
                              Identifier: 'moduleInfo'
                              Identifier: 'cacheSourceFile'
                          Identifier: 'sourceFile'
                        Identifier: 'text'
                      Identifier: ' updatedModuleContent'
                  ExpressionStatement
                    CallExpression
                      Identifier: '
        baselineTsserverLogs'
                      StringLiteral
                      StringLiteral
                      Identifier: ' session'
  ExpressionStatement
    CallExpression
      Identifier: '

describe'
      StringLiteral
      ArrowFunction
        EqualsGreaterThanToken
        Block
          ExpressionStatement
            CallExpression
              Identifier: '
    it'
              StringLiteral
              ArrowFunction
                EqualsGreaterThanToken
                Block
                  VariableStatement
                    VariableDeclarationList
                      VariableDeclaration
                        Identifier: ' host'
                        CallExpression
                          PropertyAccessExpression
                            Identifier: ' TestServerHost'
                            Identifier: 'createServerHost'
                          ObjectLiteralExpression
                  VariableStatement
                    VariableDeclarationList
                      VariableDeclaration
                        Identifier: ' session'
                        NewExpression
                          Identifier: ' TestSession'
                          ObjectLiteralExpression
                            ShorthandPropertyAssignment
                              Identifier: ' host'
                            PropertyAssignment
                              Identifier: ' useInferredProjectPerProjectRoot'
                              TrueKeyword
                  VariableStatement
                    VariableDeclarationList
                      VariableDeclaration
                        Identifier: ' newText'
                        StringLiteral
                  VariableStatement
                    VariableDeclarationList
                      VariableDeclaration
                        Identifier: ' content'
                        TemplateExpression
                          TemplateHead
                          TemplateSpan
                            Identifier: 'newText'
                            TemplateTail
                  ExpressionStatement
                    CallExpression
                      Identifier: '
        openFilesForSession'
                      ArrayLiteralExpression
                        ObjectLiteralExpression
                          PropertyAssignment
                            Identifier: ' file'
                            StringLiteral
                          ShorthandPropertyAssignment
                            Identifier: ' content'
                          PropertyAssignment
                            Identifier: ' scriptKindName'
                            StringLiteral
                          PropertyAssignment
                            Identifier: ' projectRootPath'
                            StringLiteral
                        ObjectLiteralExpression
                          PropertyAssignment
                            Identifier: ' file'
                            StringLiteral
                          ShorthandPropertyAssignment
                            Identifier: ' content'
                          PropertyAssignment
                            Identifier: ' scriptKindName'
                            StringLiteral
                          PropertyAssignment
                            Identifier: ' projectRootPath'
                            StringLiteral
                      Identifier: ' session'
                  ExpressionStatement
                    CallExpression
                      Identifier: '
        closeFilesForSession'
                      ArrayLiteralExpression
                        StringLiteral
                      Identifier: ' session'
                  ExpressionStatement
                    CallExpression
                      PropertyAccessExpression
                        Identifier: '
        session'
                        Identifier: 'executeCommandSeq'
                      TypeReference
                        QualifiedName
                          QualifiedName
                            QualifiedName
                              Identifier: 'ts'
                              Identifier: 'server'
                            Identifier: 'protocol'
                          Identifier: 'UpdateOpenRequest'
                      ObjectLiteralExpression
                        PropertyAssignment
                          Identifier: '
            command'
                          PropertyAccessExpression
                            PropertyAccessExpression
                              PropertyAccessExpression
                                PropertyAccessExpression
                                  Identifier: ' ts'
                                  Identifier: 'server'
                                Identifier: 'protocol'
                              Identifier: 'CommandTypes'
                            Identifier: 'UpdateOpen'
                        PropertyAssignment
                          Identifier: '
            arguments'
                          ObjectLiteralExpression
                            PropertyAssignment
                              Identifier: '
                changedFiles'
                              ArrayLiteralExpression
                                ObjectLiteralExpression
                                  PropertyAssignment
                                    Identifier: '
                    fileName'
                                    StringLiteral
                                  PropertyAssignment
                                    Identifier: '
                    textChanges'
                                    ArrayLiteralExpression
                                      ObjectLiteralExpression
                                        ShorthandPropertyAssignment
                                          Identifier: '
                        newText'
                                        PropertyAssignment
                                          Identifier: '
                        start'
                                          ObjectLiteralExpression
                                            PropertyAssignment
                                              Identifier: ' line'
                                              NumericLiteral
                                            PropertyAssignment
                                              Identifier: ' offset'
                                              NumericLiteral
                                        PropertyAssignment
                                          Identifier: '
                        end'
                                          ObjectLiteralExpression
                                            PropertyAssignment
                                              Identifier: ' line'
                                              NumericLiteral
                                            PropertyAssignment
                                              Identifier: ' offset'
                                              BinaryExpression
                                                PropertyAccessExpression
                                                  Identifier: ' newText'
                                                  Identifier: 'length'
                                                PlusToken
                                                NumericLiteral
                            PropertyAssignment
                              Identifier: '
                openFiles'
                              ArrayLiteralExpression
                                ObjectLiteralExpression
                                  PropertyAssignment
                                    Identifier: '
                        file'
                                    StringLiteral
                                  PropertyAssignment
                                    Identifier: '
                        fileContent'
                                    Identifier: ' newText'
                                  PropertyAssignment
                                    Identifier: '
                        projectRootPath'
                                    StringLiteral
                                  PropertyAssignment
                                    Identifier: ' // Add same document with different script kind
                        scriptKindName'
                                    StringLiteral
                  ExpressionStatement
                    CallExpression
                      Identifier: '
        baselineTsserverLogs'
                      StringLiteral
                      StringLiteral
                      Identifier: ' session'
