--- old.inferTypes2.js
+++ new.inferTypes2.js
@@= skipped -25, +25 lines =@@

 //// [inferTypes2.js]
 "use strict";
-// Repros from #22755
 Object.defineProperty(exports, "__esModule", { value: true });
 exports.bar = bar;
 exports.bar2 = bar2;
@@= skipped -15, +14 lines =@@


 //// [inferTypes2.d.ts]
+// Repros from #22755
 export declare function foo<T>(obj: T): T extends () => infer P ? P : never;
-export declare function bar<T>(obj: T): T extends () => infer P ? P : never;
+export declare function bar<T>(obj: T): T extends () => infer P ? infer P : never;
 export type BadNested<T> = {
     x: T extends number ? T : string;
 };
@@= skipped -9, +10 lines =@@
     [K in keyof BadNested<infer P>]: BadNested<infer P>[K];
 } ? P : never;
 export declare function bar2<T>(obj: T): T extends {
-    x: infer P extends number ? infer P : string;
-} ? P : never;
+    x: infer P extends number ? P : string;
+} ? infer P : never;
+
+
+//// [DtsFileErrors]
+
+
+inferTypes2.d.ts(3,67): error TS1338: 'infer' declarations are only permitted in the 'extends' clause of a conditional type.
+inferTypes2.d.ts(11,33): error TS2304: Cannot find name 'P'.
+inferTypes2.d.ts(12,5): error TS1338: 'infer' declarations are only permitted in the 'extends' clause of a conditional type.
+
+
+==== inferTypes2.d.ts (3 errors) ====
+    // Repros from #22755
+    export declare function foo<T>(obj: T): T extends () => infer P ? P : never;
+    export declare function bar<T>(obj: T): T extends () => infer P ? infer P : never;
+                                                                      ~~~~~~~
+!!! error TS1338: 'infer' declarations are only permitted in the 'extends' clause of a conditional type.
+    export type BadNested<T> = {
+        x: T extends number ? T : string;
+    };
+    export declare function foo2<T>(obj: T): T extends {
+        [K in keyof BadNested<infer P>]: BadNested<infer P>[K];
+    } ? P : never;
+    export declare function bar2<T>(obj: T): T extends {
+        x: infer P extends number ? P : string;
+                                    ~
+!!! error TS2304: Cannot find name 'P'.
+    } ? infer P : never;
+        ~~~~~~~
+!!! error TS1338: 'infer' declarations are only permitted in the 'extends' clause of a conditional type.
+    