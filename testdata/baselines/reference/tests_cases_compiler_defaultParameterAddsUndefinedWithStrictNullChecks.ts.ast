SourceFile
  FunctionDeclaration
    Identifier: ' f'
    Parameter
      Identifier: 'addUndefined1'
      StringLiteral
    Parameter
      Identifier: ' addUndefined2'
      QuestionToken
      NumberKeyword
    Block
      ReturnStatement
        BinaryExpression
          PropertyAccessExpression
            Identifier: ' addUndefined1'
            Identifier: 'length'
          PlusToken
          ParenthesizedExpression
            BinaryExpression
              Identifier: 'addUndefined2'
              BarBarToken
              NumericLiteral
  FunctionDeclaration
    Identifier: ' g'
    Parameter
      Identifier: 'addUndefined'
      StringLiteral
    Parameter
      Identifier: ' addDefined'
      NumberKeyword
    Block
      ReturnStatement
        BinaryExpression
          PropertyAccessExpression
            Identifier: ' addUndefined'
            Identifier: 'length'
          PlusToken
          Identifier: ' addDefined'
  VariableStatement
    VariableDeclarationList
      VariableDeclaration
        Identifier: ' total'
        BinaryExpression
          BinaryExpression
            BinaryExpression
              CallExpression
                Identifier: ' f'
              PlusToken
              CallExpression
                Identifier: ' f'
                StringLiteral
                NumericLiteral
            PlusToken
            CallExpression
              Identifier: ' f'
              StringLiteral
          PlusToken
          CallExpression
            Identifier: ' f'
            Identifier: 'undefined'
            NumericLiteral
  ExpressionStatement
    BinaryExpression
      Identifier: '
total'
      EqualsToken
      BinaryExpression
        CallExpression
          Identifier: ' g'
          StringLiteral
          NumericLiteral
        PlusToken
        CallExpression
          Identifier: ' g'
          Identifier: 'undefined'
          NumericLiteral
  FunctionDeclaration
    Identifier: ' foo1'
    Parameter
      Identifier: 'x'
      StringKeyword
      StringLiteral
    Parameter
      Identifier: ' b'
      NumberKeyword
    Block
      ExpressionStatement
        PropertyAccessExpression
          Identifier: '
    x'
          Identifier: 'length'
  FunctionDeclaration
    Identifier: ' foo2'
    Parameter
      Identifier: 'x'
      StringLiteral
    Parameter
      Identifier: ' b'
      NumberKeyword
    Block
      ExpressionStatement
        PropertyAccessExpression
          Identifier: '
    x'
          Identifier: 'length'
  FunctionDeclaration
    Identifier: ' foo3'
    Parameter
      Identifier: 'x'
      UnionType
        StringKeyword
        UndefinedKeyword
      StringLiteral
    Parameter
      Identifier: ' b'
      NumberKeyword
    Block
      ExpressionStatement
        PropertyAccessExpression
          Identifier: '
    x'
          Identifier: 'length'
      ExpressionStatement
        BinaryExpression
          Identifier: ' // ok, should be string
    x'
          EqualsToken
          Identifier: ' undefined'
  FunctionDeclaration
    Identifier: ' foo4'
    Parameter
      Identifier: 'x'
      UnionType
        StringKeyword
        UndefinedKeyword
      Identifier: ' undefined'
    Parameter
      Identifier: ' b'
      NumberKeyword
    Block
      ExpressionStatement
        Identifier: '
    x'
      ExpressionStatement
        BinaryExpression
          Identifier: ' // should be string | undefined
    x'
          EqualsToken
          Identifier: ' undefined'
  TypeAliasDeclaration
    Identifier: ' OptionalNullableString'
    UnionType
      StringKeyword
      LiteralType
        NullKeyword
      UndefinedKeyword
  FunctionDeclaration
    Identifier: ' allowsNull'
    Parameter
      Identifier: 'val'
      TypeReference
        Identifier: ' OptionalNullableString'
      StringLiteral
    Block
      ExpressionStatement
        BinaryExpression
          Identifier: '
    val'
          EqualsToken
          NullKeyword
      ExpressionStatement
        BinaryExpression
          Identifier: '
    val'
          EqualsToken
          StringLiteral
  ExpressionStatement
    CallExpression
      Identifier: '
allowsNull'
      NullKeyword
  ExpressionStatement
    CallExpression
      Identifier: ' // still allows passing null



// .d.ts should have `string | undefined` for foo1, foo2, foo3 and foo4
foo1'
      Identifier: 'undefined'
      NumericLiteral
  ExpressionStatement
    CallExpression
      Identifier: '
foo2'
      Identifier: 'undefined'
      NumericLiteral
  ExpressionStatement
    CallExpression
      Identifier: '
foo3'
      Identifier: 'undefined'
      NumericLiteral
  ExpressionStatement
    CallExpression
      Identifier: '
foo4'
      Identifier: 'undefined'
      NumericLiteral
  FunctionDeclaration
    Identifier: ' removeUndefinedButNotFalse'
    Parameter
      Identifier: 'x'
      TrueKeyword
    Block
      IfStatement
        BinaryExpression
          Identifier: 'x'
          EqualsEqualsEqualsToken
          FalseKeyword
        Block
          ReturnStatement
            Identifier: ' x'
  VariableStatement
    DeclareKeyword
    VariableDeclarationList
      VariableDeclaration
        Identifier: ' cond'
        BooleanKeyword
  FunctionDeclaration
    Identifier: ' removeNothing'
    Parameter
      Identifier: 'y'
      ConditionalExpression
        Identifier: ' cond'
        QuestionToken
        TrueKeyword
        ColonToken
        Identifier: ' undefined'
    Block
      IfStatement
        BinaryExpression
          Identifier: 'y'
          ExclamationEqualsEqualsToken
          Identifier: ' undefined'
        Block
          IfStatement
            BinaryExpression
              Identifier: 'y'
              EqualsEqualsEqualsToken
              FalseKeyword
            Block
              ReturnStatement
                Identifier: ' y'
      ReturnStatement
        TrueKeyword
