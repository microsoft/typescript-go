#!/usr/bin/env bash

cd "$(dirname "$0")"

curl -sL https://raw.githubusercontent.com/microsoft/vscode-languageserver-node/dadd73f7fc283b4d0adb602adadcf4be16ef3a7b/protocol/metaModel.schema.json > metaModel.schema.json

json -I -f metaModel.schema.json -e 'Object.assign(this, this.definitions.MetaModel); delete this.definitions.MetaModel'

echo "// Code generated by generate.sh; DO NOT EDIT." > metamodel_generated.go
echo >> metamodel_generated.go

npx quicktype --src-lang schema --lang go --top-level MetaModel --package metamodel < metaModel.schema.json >> metamodel_generated.go

gofumpt -lang=go1.23 -w metamodel_generated.go
